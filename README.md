# HAUT-checkin
河南工业大学自动校外打卡  
请部署至腾讯云函数或其他平台

## 更新
> 2021.11.3  
> 项目更新，但文档未更新，以下使用方法可能有部分缺失或失效，请使用者自行搜索解决方式

## 特点
- 多人打卡
- 使用简单，仅需账号密码以及用于微信推送的uid
- 自动获取上一次打卡信息用于打卡
- 向所有成员微信单独推送打卡状态 
- 完美校园服务器繁忙时造成打卡失败会自动重新打卡，直到所有成员成功打卡

## 更新日志

2021.1.31 解决完美校园新设备需要验证码问题，重构项目，放弃github actions

## 使用方法  

[点这里](https://github.com/themanforfree/HAUT-checkin/releases/download/v0.1.0/HAUT-checkin-SCF.zip)下载源代码文件到本地

登陆[腾讯云函数控制台](https://console.cloud.tencent.com/scf/)

点击`函数服务`->`新建`创建云函数

选择`自定义函数`

`地域`可以随便选

`运行环境`选择`python3.6`

`提交方法`选择`本地上传zip包`

点击`上传`选择刚刚下载的zip文件

展开`高级配置`子菜单

`执行超时时间`设置为`900`秒

然后点击此链接获取二维码

[QRcode](http://wxpusher.zjiecode.com/api/qrcode/1men6ZnAtqckyldYHDbYfOKSsqcxxhXtu6nXChdP9iybdir048fJ1VxU0W5Kwlgo.jpg)

每个用户都需要扫描此二维码关注新消息服务公众号用于推送打卡状态

关注后在公众号内依次点击`我的`->`我的UID`，获取每个用户的UID

在环境变量处按照以下格式填入打卡成员信息

device_seed 可填入任意数字

建议不要让多个用户的device_seed相同

| key     | Value          | 
| :------ | :--------------|
| `user1` | `账号` `密码` `device_seed uid` | 
| `user2` | `账号` `密码` `device_seed uid` | 


展开`触发器配置`子菜单

`触发周期`选择`自定义触发周期`

`cron表达式`填入`0 10 0 * * * *`

即为凌晨00:10打卡，第二位表示分钟，第三位表示小时

可自行修改打卡时间

点击`完成`

以上步骤完成后

进入`函数代码`页面

点击左侧的`SMS.py`

在点击右上角的`绿色小三角`运行此脚本

用于验证虚拟的新设备

在命令行依次填入`username`和刚刚填入环境变量的`device_seed`

然后输入收到的验证码

至此所有步骤完成

你可以点击页面下方的`测试`来验证是否出错

部署完成后如需添加打卡成员，修改函数配置添加环境变量即可

**部署成功后第一次使用时，请在打卡时间确认脚本运行正常，默认每日00:10开始打卡**

**注意：本项目默认学校为河南工业大学，其他学校请自行修改代码。**




